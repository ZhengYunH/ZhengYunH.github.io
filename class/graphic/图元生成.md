# 图元生成  

## 输出图元（Output Primitive）
1. 线画图元：
    + 矢量表示
    + 数学方程离散化为点阵表示，是个扫描转换的过程
2. 填充图元：
    + 点阵表示
    + 确定定义图形点阵区域的内部点表示
## 基本操作
1. 画点：将单个坐标位置转换成输出设备的合适操作  
2. 画线：通过计算沿线路径上两指定端点位置间的中间位置

## 线画图元生成  
+ 扫描转换的过程：图元的数学形式转换成点阵表示
+ 连续线段->离散点集

### 基本思想
1. 确定直线的方程
2. 计算出靠近直线的像素集
3. 以该像素集近似代替原有直线段

产生台阶状：取决于分辨率

### 像素编址  
1. 像素网格坐标：对象中心与像素中心对准
2. 屏幕网格坐标：物体边界与像素边界对准

### 随机扫描图元生成
+ 由斜率m的绝对值决定偏转电压
    1. $ |m|<1 $ ,设置对应于$ \Delta x $的水平偏转电压，垂直偏转电压由 $ \Delta y $来确定
    2. $ |m|>1 $ ,设置对应于$ \Delta y $的水平偏转电压，垂直偏转电压由 $ \Delta x $来确定
    3. $ |m|=1 $

### DDA：Digital Differential Analyzer  
1. 计算端点间的水平和垂直差值
2. 绝对值大者决定算法循环次数
3. 从某一端点开始，确定沿线段下一像素位置的偏移量（ 1\k or k）并取整
4. 重复循环3

### 中点画线法
直线的一般式方程$ F(x,y)=Ax+By+C=0 $  
其中$ A=- \Delta y =y_0-y_1 , B=\Delta x = x_1-x_0 , C=x_0y_1 - x_1y_0$   
因此，可以将平面划分为三个部分
![](http://img.blog.csdn.net/20160924202825913)  
将$M(x_i+1,y_i+0.5)$代入$F(x,y)$可以得到
$$ d=F(M)=F(x_i+1,y_i+0.5) $$
![](http://img.blog.csdn.net/20160924203145820)

+ 当d<0时，M在直线下方，取$P_u(x_i+1,y_i+1)$  
+ 当d>0时，M在直线下方，取$P_d(x_i+1,y_i)$
+ 当d>0时，M在直线上，二者相同，取$P_d(x_i+1,y_i)$

#### 画线
+ $ d \geq 0 $ 时，取正右方的像素$P_d$，再判断下一个像素应该取哪个，应该计算
$$ d_1=F(x_i+2,y_i+0.5)=a(x_i+2)+b(y_i+0.5)+c=d+a $$
因此，d的增量为a

+ $ d<0 $ 时，d的增量为a+b，即$ d_2=F(x_i+2,y_i+1.5)=d+a+b $
+ $ d_0=F(x_0+1,y_0+0.5)=F(x_0+y_0)+a+0.5b=0+a+0.5b=a+0.5b $
因为只考虑方向，因此可以考虑使用2d代替d的计算


### Bresenham 算法
$$
y=mx_{k+1}+b=m(x_k + 1)+b\\
d_1=y-y_k\\
d_2=y_{k+1}-y\\
d_1-d_2=2y-y_k+y_{k+1}=2m(x_k+1)
$$